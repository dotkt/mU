Copyright (c) 2007~2011 Siang Zhang and contributors.